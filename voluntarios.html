<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <!--
    ============================================================
    Plataforma ONG — VOLUNTARIADO
    Entrega I – Fundamentos e Estruturação
    Requisitos atendidos:
      • Estrutura semântica (header/nav/main/section/footer)
      • Formulário complexo com validação HTML5
      • Máscaras (CPF/Telefone/CEP) em JS
      • Integração ViaCEP (API pública) para autocompletar endereço
      • Comentários explicativos
    ============================================================
  -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voluntariado • Plataforma ONG</title>
  <meta name="description" content="Cadastre-se como voluntário e participe das ações da ONG." />

  <!-- Estilos do projeto -->
  <link rel="stylesheet" href="css/reset.css" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- ===================== Cabeçalho / Navegação ===================== -->
  <header>
    <nav aria-label="Navegação principal do site">
      <ul>
        <li><a href="index.html">Início</a></li>
        <li><a href="sobre.html">Sobre</a></li>
        <li><a href="projetos.html">Projetos</a></li>
        <li><a href="voluntariado.html" aria-current="page">Voluntariado</a></li>
        <li><a href="doacoes.html">Como Doar</a></li>
        <li><a href="transparencia.html">Transparência</a></li>
        <li><a href="contato.html">Contato</a></li>
        <li><a href="blog.html">Blog/Notícias</a></li>
      </ul>
    </nav>
  </header>

  <!-- ========================= Conteúdo Principal ========================= -->
  <main id="conteudo-principal">
    <section class="card" aria-labelledby="titulo-vol">
      <h1 id="titulo-vol">Cadastro de Voluntário</h1>
      <p>Preencha seus dados para participar das ações da ONG.</p>
    </section>

    <!-- Formulário com validação, máscaras e ViaCEP -->
    <section class="card" aria-labelledby="titulo-form">
      <h2 id="titulo-form">Seus dados</h2>

      <!--
        novalidate: manteremos a validação HTML5, mas controlaremos a UX no submit
        via JS, focando no primeiro campo inválido.
      -->
      <form id="form-voluntario" action="#" method="post" novalidate>
        <!-- Dados pessoais -->
        <fieldset>
          <legend>Dados pessoais</legend>

          <label for="nome">Nome completo *</label>
          <input id="nome" name="nome" autocomplete="name" required />

          <label for="email">E-mail *</label>
          <input id="email" name="email" type="email" autocomplete="email" required />

          <!-- CPF com máscara e pattern de fallback -->
          <label for="cpf">CPF *</label>
          <input
            id="cpf" name="cpf" inputmode="numeric" maxlength="14"
            placeholder="000.000.000-00"
            pattern="^\d{3}\.?\d{3}\.?\d{3}-?\d{2}$"
            required
            aria-describedby="ajuda-cpf"
          />
          <small id="ajuda-cpf">Digite apenas números — a máscara aparece automaticamente.</small>

          <!-- Telefone com máscara -->
          <label for="tel">Telefone *</label>
          <input
            id="tel" name="tel" inputmode="tel" maxlength="16"
            placeholder="(00) 00000-0000" required
          />
        </fieldset>

        <!-- Endereço (CEP + ViaCEP) -->
        <fieldset>
          <legend>Endereço</legend>

          <label for="cep">CEP *</label>
          <input
            id="cep" name="cep" inputmode="numeric" maxlength="9"
            placeholder="00000-000" required
            pattern="^\d{5}-?\d{3}$"
            aria-describedby="ajuda-cep"
          />
          <small id="ajuda-cep">Ao completar o CEP, buscamos seu endereço automaticamente (ViaCEP).</small>

          <label for="logradouro">Logradouro *</label>
          <input id="logradouro" name="logradouro" required />

          <label for="bairro">Bairro *</label>
          <input id="bairro" name="bairro" required />

          <label for="cidade">Cidade *</label>
          <input id="cidade" name="cidade" required />

          <label for="uf">UF *</label>
          <input id="uf" name="uf" maxlength="2" placeholder="SP" required />
        </fieldset>

        <!-- Habilidades e disponibilidade -->
        <fieldset>
          <legend>Habilidades e disponibilidade</legend>

          <label for="habilidades">Habilidades (selecione as que se aplicam)</label>
          <select id="habilidades" name="habilidades" multiple size="4" aria-describedby="ajuda-hab">
            <option>Escuta e acolhimento</option>
            <option>Psicologia/Serviço Social</option>
            <option>Administração/Logística</option>
            <option>Comunicação/Design</option>
          </select>
          <small id="ajuda-hab">Use Ctrl/Cmd para selecionar múltiplas habilidades.</small>

          <fieldset>
            <legend>Disponibilidade (turnos)</legend>
            <label><input type="checkbox" name="turno" value="manha" /> Manhã</label>
            <label><input type="checkbox" name="turno" value="tarde" /> Tarde</label>
            <label><input type="checkbox" name="turno" value="noite" /> Noite</label>
          </fieldset>
        </fieldset>

        <!-- Preferências -->
        <fieldset>
          <legend>Preferências</legend>
          <label><input type="checkbox" name="newsletter" value="sim" /> Quero receber notícias por e-mail</label>
        </fieldset>

        <button type="submit">Enviar cadastro</button>
      </form>
    </section>
  </main>

  <!-- ============================== Rodapé ============================== -->
  <footer>
    <small>&copy; <span id="ano-atual"></span> ONG Exemplo • Todos os direitos reservados</small>
  </footer>

  <!-- ============================== Scripts ============================== -->
  <script>
    // Atualiza o ano no rodapé (melhor UX)
    document.getElementById('ano-atual').textContent = new Date().getFullYear();

    /*
      ============================================================
      MÁSCARAS (CPF, TELEFONE, CEP) — JS puro
      ============================================================
      • Implementações simples e performáticas.
      • Não dependem de bibliotecas externas.
    */
    function maskCPF(el) {
      let v = el.value.replace(/\D/g, '').slice(0, 11);
      v = v.replace(/(\d{3})(\d)/, '$1.$2')
           .replace(/(\d{3})(\d)/, '$1.$2')
           .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
      el.value = v;
    }

    function maskPhone(el) {
      let v = el.value.replace(/\D/g, '').slice(0, 11);
      v = v.replace(/^(\d{2})(\d)/, '($1) $2')
           .replace(/(\d{5})(\d{1,4})$/, '$1-$2');
      el.value = v;
    }

    function maskCEP(el) {
      let v = el.value.replace(/\D/g, '').slice(0, 8);
      v = v.replace(/(\d{5})(\d{1,3})/, '$1-$2');
      el.value = v;
    }

    // Aplica máscaras em tempo real
    document.addEventListener('input', (e) => {
      if (e.target.id === 'cpf') maskCPF(e.target);
      if (e.target.id === 'tel') maskPhone(e.target);
      if (e.target.id === 'cep') maskCEP(e.target);
    });

    /*
      ============================================================
      VIA CEP — Busca de endereço automática
      ============================================================
      • Usa fetch com template string (CRASES) na URL.
      • Trata erro da API e de rede via try/catch.
      • Preenche logradouro, bairro, cidade e UF.
      • Atenção: se abrir o HTML via file://, o fetch pode ser bloqueado.
        Rode com servidor local (ex.: Live Server).
    */
    async function buscaCEP(cepLimpo) {
  try {
    // use CRASES ( ` ) para interpolar ${cepLimpo}
    const resposta = await fetch('https://visioncep.com.br/ws/' + cepLimpo + '/json/');
    const data = await resposta.json();
    if (data && !data.erro) {
      const $ = (id) => document.getElementById(id);
      $('logradouro').value = data.logradouro || '';
      $('bairro').value     = data.bairro || '';
      $('cidade').value     = data.localidade || '';
      $('uf').value         = data.uf || '';
    }
  } catch (err) {
    console.error('Erro ao buscar o CEP:', err);
  }
}

    // Dispara busca quando o CEP completar 8 dígitos
    document.getElementById('cep').addEventListener('input', (e) => {
      const v = e.target.value.replace(/\D/g, '');
      if (v.length === 8) {
        buscaCEP(v);
      }
    });

    /*
      ============================================================
      Validação HTML5 com UX melhorada no envio
      ============================================================
      • Impede submit se houver campos inválidos.
      • Foca automaticamente no primeiro campo inválido.
    */
    document.getElementById('form-voluntario').addEventListener('submit', (e) => {
      const form = e.target;
      if (!form.checkValidity()) {
        e.preventDefault();
        const primeiroInvalido = form.querySelector(':invalid');
        if (primeiroInvalido) {
          primeiroInvalido.focus();
        }
      }
    });
  </script>
</body>
</html>